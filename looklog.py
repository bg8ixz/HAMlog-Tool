# -*- coding: utf-8 -*-

# Form implementation generated from reading ui file 'looklog.ui'
#
# Created by: PyQt5 UI code generator 5.15.10
#
# WARNING: Any manual changes made to this file will be lost when pyuic5 is
# run again.  Do not edit this file unless you know what you are doing.
import pandas as pd
import openpyxl
from openpyxl.styles import Alignment, Font, PatternFill, Border, Side
from openpyxl.utils import get_column_letter
from openpyxl.utils.dataframe import dataframe_to_rows
import os, re, sqlite3, logging ,csv, threading,base64
from datetime import datetime, timedelta
from PyQt5 import QtCore, QtGui, QtWidgets
from PyQt5.QtWidgets import QMainWindow, QLineEdit, QWidget, QRadioButton, QTableView, QHeaderView, QStyledItemDelegate, QMessageBox, QInputDialog, QFileDialog, QAbstractItemView, QApplication
from PyQt5.QtCore import Qt, QTimer,  QDate, QTime, QDateTime, QLocale, QRegExp, QAbstractTableModel, QModelIndex, QSortFilterProxyModel
from PyQt5.QtGui import QStandardItemModel, QStandardItem, QValidator, QIcon,QPixmap,QImage


class Ui_looklog_Form(object):
    def setupUi(self, looklog_Form):
        looklog_Form.setObjectName("looklog_Form")
        looklog_Form.resize(1298, 538)
        font = QtGui.QFont()
        font.setFamily("黑体")
        font.setPointSize(10)
        looklog_Form.setFont(font)
        self.suoyoulog_tableView = QtWidgets.QTableView(looklog_Form)
        self.suoyoulog_tableView.setGeometry(QtCore.QRect(20, 100, 1261, 421))
        self.suoyoulog_tableView.setObjectName("suoyoulog_tableView")
        self.groupBox = QtWidgets.QGroupBox(looklog_Form)
        self.groupBox.setGeometry(QtCore.QRect(20, 10, 491, 80))
        self.groupBox.setObjectName("groupBox")
        self.today_xuanze_Button = QtWidgets.QRadioButton(self.groupBox)
        self.today_xuanze_Button.setGeometry(QtCore.QRect(75, 20, 65, 16))
        self.today_xuanze_Button.setObjectName("today_xuanze_Button")
        self.day3_xuanze_Button = QtWidgets.QRadioButton(self.groupBox)
        self.day3_xuanze_Button.setGeometry(QtCore.QRect(140, 20, 65, 16))
        self.day3_xuanze_Button.setObjectName("day3_xuanze_Button")
        self.day7_xuanze_Button = QtWidgets.QRadioButton(self.groupBox)
        self.day7_xuanze_Button.setGeometry(QtCore.QRect(210, 20, 65, 16))
        self.day7_xuanze_Button.setObjectName("day7_xuanze_Button")
        self.day30_xuanze_Button = QtWidgets.QRadioButton(self.groupBox)
        self.day30_xuanze_Button.setGeometry(QtCore.QRect(282, 20, 65, 16))
        self.day30_xuanze_Button.setObjectName("day30_xuanze_Button")
        self.zidingyi_xuanze_Button = QtWidgets.QRadioButton(self.groupBox)
        self.zidingyi_xuanze_Button.setGeometry(QtCore.QRect(10, 52, 70, 16))
        self.zidingyi_xuanze_Button.setObjectName("zidingyi_xuanze_Button")
        self.kaishi_dateTimeEdit = QtWidgets.QDateTimeEdit(self.groupBox)
        self.kaishi_dateTimeEdit.setGeometry(QtCore.QRect(80, 46, 160, 22))
        self.kaishi_dateTimeEdit.setCalendarPopup(True)
        self.kaishi_dateTimeEdit.setTimeSpec(QtCore.Qt.LocalTime)
        self.kaishi_dateTimeEdit.setObjectName("kaishi_dateTimeEdit")
        self.lianjiefu_label = QtWidgets.QLabel(self.groupBox)
        self.lianjiefu_label.setGeometry(QtCore.QRect(246, 42, 16, 30))
        self.lianjiefu_label.setObjectName("lianjiefu_label")
        self.jiezhi_dateTimeEdit = QtWidgets.QDateTimeEdit(self.groupBox)
        self.jiezhi_dateTimeEdit.setGeometry(QtCore.QRect(260, 46, 160, 22))
        self.jiezhi_dateTimeEdit.setCalendarPopup(True)
        self.jiezhi_dateTimeEdit.setTimeSpec(QtCore.Qt.LocalTime)
        self.jiezhi_dateTimeEdit.setObjectName("jiezhi_dateTimeEdit")
        self.day90_xuanze_Button = QtWidgets.QRadioButton(self.groupBox)
        self.day90_xuanze_Button.setGeometry(QtCore.QRect(360, 20, 65, 16))
        self.day90_xuanze_Button.setObjectName("day90_xuanze_Button")
        self.all_xuanze_Button = QtWidgets.QRadioButton(self.groupBox)
        self.all_xuanze_Button.setGeometry(QtCore.QRect(10, 20, 51, 16))
        self.all_xuanze_Button.setObjectName("all_xuanze_Button")
        self.shaixuan_pushButton = QtWidgets.QPushButton(self.groupBox)
        self.shaixuan_pushButton.setGeometry(QtCore.QRect(430, 19, 50, 50))
        self.shaixuan_pushButton.setObjectName("shaixuan_pushButton")
        self.groupBox_2 = QtWidgets.QGroupBox(looklog_Form)
        self.groupBox_2.setGeometry(QtCore.QRect(1010, 10, 271, 80))
        self.groupBox_2.setObjectName("groupBox_2")
        self.clearlog_pushButton = QtWidgets.QPushButton(self.groupBox_2)
        self.clearlog_pushButton.setGeometry(QtCore.QRect(15, 29, 75, 30))
        self.clearlog_pushButton.setObjectName("clearlog_pushButton")
        self.tolog_pushButton = QtWidgets.QPushButton(self.groupBox_2)
        self.tolog_pushButton.setGeometry(QtCore.QRect(100, 29, 75, 30))
        self.tolog_pushButton.setObjectName("tolog_pushButton")
        self.xiugailog_pushButton = QtWidgets.QPushButton(self.groupBox_2)
        self.xiugailog_pushButton.setGeometry(QtCore.QRect(183, 29, 75, 30))
        self.xiugailog_pushButton.setObjectName("xiugailog_pushButton")
        self.groupBox_3 = QtWidgets.QGroupBox(looklog_Form)
        self.groupBox_3.setGeometry(QtCore.QRect(520, 10, 261, 80))
        self.groupBox_3.setObjectName("groupBox_3")
        self.shaixuan_label = QtWidgets.QLabel(self.groupBox_3)
        self.shaixuan_label.setGeometry(QtCore.QRect(10, 40, 81, 30))
        self.shaixuan_label.setObjectName("shaixuan_label")
        self.hejitonglian_label = QtWidgets.QLabel(self.groupBox_3)
        self.hejitonglian_label.setGeometry(QtCore.QRect(92, 27, 91, 41))
        font = QtGui.QFont()
        font.setPointSize(28)
        self.hejitonglian_label.setFont(font)
        self.hejitonglian_label.setAlignment(QtCore.Qt.AlignCenter)
        self.hejitonglian_label.setObjectName("hejitonglian_label")
        self.label_3 = QtWidgets.QLabel(self.groupBox_3)
        self.label_3.setGeometry(QtCore.QRect(190, 40, 54, 30))
        self.label_3.setObjectName("label_3")
        self.groupBox_4 = QtWidgets.QGroupBox(looklog_Form)
        self.groupBox_4.setGeometry(QtCore.QRect(790, 10, 211, 80))
        self.groupBox_4.setObjectName("groupBox_4")
        self.search_callsign_lineEdit = QtWidgets.QLineEdit(self.groupBox_4)
        self.search_callsign_lineEdit.setGeometry(QtCore.QRect(80, 20, 121, 22))
        self.search_callsign_lineEdit.setObjectName("search_callsign_lineEdit")
        self.label_4 = QtWidgets.QLabel(self.groupBox_4)
        self.label_4.setGeometry(QtCore.QRect(10, 20, 61, 30))
        self.label_4.setObjectName("label_4")
        self.label_5 = QtWidgets.QLabel(self.groupBox_4)
        self.label_5.setGeometry(QtCore.QRect(30, 50, 61, 30))
        self.label_5.setObjectName("label_5")
        self.label_6 = QtWidgets.QLabel(self.groupBox_4)
        self.label_6.setGeometry(QtCore.QRect(160, 50, 31, 30))
        self.label_6.setObjectName("label_6")
        self.zonggongtonglian_label = QtWidgets.QLabel(self.groupBox_4)
        self.zonggongtonglian_label.setGeometry(QtCore.QRect(95, 46, 60, 31))
        font = QtGui.QFont()
        font.setPointSize(18)
        self.zonggongtonglian_label.setFont(font)
        self.zonggongtonglian_label.setAlignment(QtCore.Qt.AlignCenter)
        self.zonggongtonglian_label.setObjectName("zonggongtonglian_label")

        self.retranslateUi(looklog_Form)
        QtCore.QMetaObject.connectSlotsByName(looklog_Form)

    def retranslateUi(self, looklog_Form):
        _translate = QtCore.QCoreApplication.translate
        looklog_Form.setWindowTitle(_translate("looklog_Form", "通联日志记录"))
        self.groupBox.setTitle(_translate("looklog_Form", "时间范围"))
        self.today_xuanze_Button.setText(_translate("looklog_Form", "今天"))
        self.day3_xuanze_Button.setText(_translate("looklog_Form", "近3天"))
        self.day7_xuanze_Button.setText(_translate("looklog_Form", "近7天"))
        self.day30_xuanze_Button.setText(_translate("looklog_Form", "近30天"))
        self.zidingyi_xuanze_Button.setText(_translate("looklog_Form", "自定义"))
        self.kaishi_dateTimeEdit.setDisplayFormat(_translate("looklog_Form", "yyyy-M-d HH:mm:ss"))
        self.lianjiefu_label.setText(_translate("looklog_Form", "-"))
        self.jiezhi_dateTimeEdit.setDisplayFormat(_translate("looklog_Form", "yyyy-M-d HH:mm:ss"))
        self.day90_xuanze_Button.setText(_translate("looklog_Form", "近90天"))
        self.all_xuanze_Button.setText(_translate("looklog_Form", "全部"))
        self.shaixuan_pushButton.setText(_translate("looklog_Form", "筛选"))
        self.groupBox_2.setTitle(_translate("looklog_Form", "控制台"))
        self.clearlog_pushButton.setText(_translate("looklog_Form", "清空日志"))
        self.tolog_pushButton.setText(_translate("looklog_Form", "导出日志"))
        self.xiugailog_pushButton.setText(_translate("looklog_Form", "提交修改"))
        self.groupBox_3.setTitle(_translate("looklog_Form", "统计信息"))
        self.shaixuan_label.setText(_translate("looklog_Form", "已累计通联："))
        self.hejitonglian_label.setText(_translate("looklog_Form", "0"))
        self.label_3.setText(_translate("looklog_Form", "位友台"))
        self.groupBox_4.setTitle(_translate("looklog_Form", "通联查询"))
        self.search_callsign_lineEdit.setPlaceholderText(_translate("looklog_Form", "输入要查询的呼号"))
        self.label_4.setText(_translate("looklog_Form", "查询呼号："))
        self.label_5.setText(_translate("looklog_Form", "总计通联："))
        self.label_6.setText(_translate("looklog_Form", "次"))
        self.zonggongtonglian_label.setText(_translate("looklog_Form", "0"))

class CenterAlignedItemDelegate(QStyledItemDelegate):
    def initStyleOption(self, option, index):
        super().initStyleOption(option, index)
        option.displayAlignment = Qt.AlignCenter

class LooklogWindow(QMainWindow):
    def __init__(self):
        super(LooklogWindow, self).__init__()
        self.ui = Ui_looklog_Form()
        self.ui.setupUi(self)
        # 把ICO转为base64编码的字符串来引入到窗口
        icon_data = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAIAAAD2HxkiAAAACXBIWXMAAAsTAAALEwEAmpwYAAAK+mlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNi4wLWMwMDYgNzkuZGFiYWNiYiwgMjAyMS8wNC8xNC0wMDozOTo0NCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyIgeG1sbnM6ZXhpZj0iaHR0cDovL25zLmFkb2JlLmNvbS9leGlmLzEuMC8iIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDIyLjQgKFdpbmRvd3MpIiB4bXA6Q3JlYXRlRGF0ZT0iMjAyNC0wNC0wMlQxMjoxNjoxNSswODowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyNC0wNC0wMlQxMjoyOToyMSswODowMCIgeG1wOk1vZGlmeURhdGU9IjIwMjQtMDQtMDJUMTI6Mjk6MjErMDg6MDAiIGRjOmZvcm1hdD0iaW1hZ2UvcG5nIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjQ3ZjM3Zjc4LTFiODctYmY0OC1iNDdkLWM5NjgzNmQ0OTQ0YSIgeG1wTU06RG9jdW1lbnRJRD0iYWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOjU3ODgwNjA0LTE2OTEtZDg0My05OGU0LTc4MTU4Yjc5MzY0OCIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOjFlYmE2ZWRkLWFlMTYtMDQ0OS05ZWZlLWI2ZDc3NTQzOTVlYyIgcGhvdG9zaG9wOkNvbG9yTW9kZT0iMyIgdGlmZjpPcmllbnRhdGlvbj0iMSIgdGlmZjpYUmVzb2x1dGlvbj0iNzIwMDAwLzEwMDAwIiB0aWZmOllSZXNvbHV0aW9uPSI3MjAwMDAvMTAwMDAiIHRpZmY6UmVzb2x1dGlvblVuaXQ9IjIiIGV4aWY6Q29sb3JTcGFjZT0iNjU1MzUiIGV4aWY6UGl4ZWxYRGltZW5zaW9uPSIzMDAiIGV4aWY6UGl4ZWxZRGltZW5zaW9uPSIzMDAiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjFlYmE2ZWRkLWFlMTYtMDQ0OS05ZWZlLWI2ZDc3NTQzOTVlYyIgc3RFdnQ6d2hlbj0iMjAyNC0wNC0wMlQxMjoxNjoxNSswODowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDIyLjQgKFdpbmRvd3MpIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDozNDFiZDM5ZC1kNWU3LTYxNGMtYTYxNy01YWZjODVhMDVlMjciIHN0RXZ0OndoZW49IjIwMjQtMDQtMDJUMTI6MjE6MjMrMDg6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCAyMi40IChXaW5kb3dzKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6MmVlNzY2ZTAtOGUzNC01NDQ2LWE0YzgtY2Y2OWRiZjZmMzczIiBzdEV2dDp3aGVuPSIyMDI0LTA0LTAyVDEyOjI5OjIxKzA4OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgMjIuNCAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNvbnZlcnRlZCIgc3RFdnQ6cGFyYW1ldGVycz0iZnJvbSBhcHBsaWNhdGlvbi92bmQuYWRvYmUucGhvdG9zaG9wIHRvIGltYWdlL3BuZyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iZGVyaXZlZCIgc3RFdnQ6cGFyYW1ldGVycz0iY29udmVydGVkIGZyb20gYXBwbGljYXRpb24vdm5kLmFkb2JlLnBob3Rvc2hvcCB0byBpbWFnZS9wbmciLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjQ3ZjM3Zjc4LTFiODctYmY0OC1iNDdkLWM5NjgzNmQ0OTQ0YSIgc3RFdnQ6d2hlbj0iMjAyNC0wNC0wMlQxMjoyOToyMSswODowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDIyLjQgKFdpbmRvd3MpIiBzdEV2dDpjaGFuZ2VkPSIvIi8+IDwvcmRmOlNlcT4gPC94bXBNTTpIaXN0b3J5PiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDoyZWU3NjZlMC04ZTM0LTU0NDYtYTRjOC1jZjY5ZGJmNmYzNzMiIHN0UmVmOmRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDo0ZmVmZmIwNS0xMTg1LTBlNGYtYWQxNS0xNmIyZDFiN2NkMTQiIHN0UmVmOm9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDoxZWJhNmVkZC1hZTE2LTA0NDktOWVmZS1iNmQ3NzU0Mzk1ZWMiLz4gPHBob3Rvc2hvcDpUZXh0TGF5ZXJzPiA8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"
        icon_data = icon_data.split(",")[1]     # 移除前缀，得到纯Base64编码数据
        jiema_icon_data = base64.b64decode(icon_data)   # 解码base64字符串为字节数据
        icon = QIcon()      # 使用字节数据创建一个QIcon对象
        icon.addPixmap(QPixmap.fromImage(QImage.fromData(jiema_icon_data)))    #在PyQt5.QtGui引入QPixmap、QImage，PyQt5.QtCore引入QByteArray
        self.setWindowIcon(icon)    # 设置窗口图标
        '''这是为了防止日志导出循环特地设置的 匹配方案二：使用标志位防止重复导出'''
        #self.is_exporting = False
        '''# 设置日志等级为DEBUG
        logging.basicConfig(level=logging.DEBUG)
        # 使用日志差错---------------------------------开始
        # 创建一个logger
        self.logger = logging.getLogger('your_logger_name')
        self.logger.setLevel(logging.DEBUG)  # 设置日志级别，可以根据需要调整

        # 创建一个handler，用于写入日志文件
        fh = logging.FileHandler('your_log_file.log')
        fh.setLevel(logging.DEBUG)  # 同样设置日志级别

        # 定义handler的输出格式
        formatter = logging.Formatter('%(asctime)s - %(name)s - %(levelname)s - %(message)s')
        fh.setFormatter(formatter)

        # 给logger添加handler
        self.logger.addHandler(fh)
        # 使用日志差错---------------------------------结束'''

        # ------------------------------------------------------------------------- 连接到数据库
        script_dir = os.path.dirname(os.path.abspath(__file__)) # 获取当前程序路径（推荐使用os.path.abspath(__file__)）
        db_path = os.path.join(script_dir, 'rx_log.db') # 连接到SQLite数据库
        self.conn = sqlite3.connect(db_path)  # 使用获取到的数据库路径
        self.cursor = self.conn.cursor()    # 获取游标对象
        # -------------------------------------------------------------------自定义时间范围开始
        # 初始化时禁用自定义日期时间范围的编辑器
        self.ui.kaishi_dateTimeEdit.setReadOnly(True)
        self.ui.jiezhi_dateTimeEdit.setReadOnly(True)
        self.ui.shaixuan_pushButton.setEnabled(False)   #禁用筛选按钮
        # 初始化时设置自定义日期时间范围的编辑器文字为灰色
        self.ui.kaishi_dateTimeEdit.setStyleSheet("color: gray;")
        self.ui.jiezhi_dateTimeEdit.setStyleSheet("color: gray;")

        # 设置自定义日期时间范围的编辑器显示格式
        display_format = "yyyy-MM-dd HH:mm:ss"
        self.ui.kaishi_dateTimeEdit.setDisplayFormat(display_format)  # 设置开始日期时间编辑器的显示格式
        self.ui.jiezhi_dateTimeEdit.setDisplayFormat(display_format)  # 设置结束日期时间编辑器的显示格式

        # 设置自定义日期时间范围的编辑器默认显示今天的日期
        today = datetime.now()
        # today = datetime.now().replace(hour=0, minute=0, second=0, microsecond=0)  # 获取当前日期，时分秒设为0
        # self.ui.kaishi_dateTimeEdit.setDateTime(today)  # 设置开始日期时间编辑器的日期时间为今天
        self.ui.kaishi_dateTimeEdit.setDateTime(today.replace(hour=0, minute=0, second=0, microsecond=0))  # 设置开始日期时间编辑器为今天凌晨
        self.ui.jiezhi_dateTimeEdit.setDateTime(today)  # 设置结束日期时间编辑器的日期时间为今天

        # 设置自定义日期时间范围的编辑器禁止选择今天之后的日期
        self.ui.kaishi_dateTimeEdit.setMaximumDateTime(today)  # 设置最大可选日期为今天
        self.ui.jiezhi_dateTimeEdit.setMaximumDateTime(today)
        # 可能的其他初始化代码...------------------------------------------------------------------------------------------------------------------------------
        # 为所有日期范围选择按钮绑定log_xuanze_Button槽函数-确保按钮点击有效
        self.ui.all_xuanze_Button.toggled.connect(self.log_xuanze_Button)
        self.ui.today_xuanze_Button.toggled.connect(self.log_xuanze_Button)
        self.ui.day3_xuanze_Button.toggled.connect(self.log_xuanze_Button)
        self.ui.day7_xuanze_Button.toggled.connect(self.log_xuanze_Button)
        self.ui.day30_xuanze_Button.toggled.connect(self.log_xuanze_Button)
        self.ui.day90_xuanze_Button.toggled.connect(self.log_xuanze_Button)
        self.ui.zidingyi_xuanze_Button.toggled.connect(self.log_xuanze_Button)
        # 将shaixuan_pushButton的clicked信号连接到log_xuanze_Button方法
        self.ui.shaixuan_pushButton.clicked.connect(self.log_xuanze_Button)
        # -----------------------------------------------------------------------清除/导出日志的信号槽---------开始--------------
        self.ui.clearlog_pushButton.clicked.connect(self.on_clearlog_button_clicked)
        self.ui.tolog_pushButton.clicked.connect(self.on_tolog_pushButton_clicked)
        # -----------------------------------------------------------------------清除/导出日志的信号槽---------结束--------------   

        # --------------------------------------------通联日志里面呼号搜索框的槽函数---------------------------------开始----------------------
        self.ui.search_callsign_lineEdit.textChanged.connect(self.on_search_callsign_changed)
        self.ui.search_callsign_lineEdit.focusInEvent = self.on_search_callsign_focus_in
        self.ui.search_callsign_lineEdit.focusOutEvent = self.on_search_callsign_focus_out
        # --------------------------------------------通联日志里面呼号搜索框的槽函数---------------------------------结束----------------------
        self.initialize_table_view()    # 初始化表格视图
        self.update_table_view()  # 添加这一行，加载所有加载初始数据
        # ----------------------------------------------下面是 开局就统计统计功能-----------------------------
        # 统计rx_callsign非空且不重复的呼号数量
        self.cursor.execute("SELECT COUNT(DISTINCT rx_callsign) FROM rx_log WHERE rx_callsign IS NOT NULL")
        total_callsigns = self.cursor.fetchone()[0]  # 获取计数结果
        self.ui.hejitonglian_label.setText(f"{total_callsigns}")        # 设置hejitonglian_label的文本为统计结果

        # 创建定时刷新
        self.timer = QTimer(interval=2000, timeout=self.refresh_data)
        self.timer.start()

        self.ui.all_xuanze_Button.setChecked(True)  # 默认选中全部按钮
        self.setFixedSize(self.size())  # 设置窗口固定大小，不允许调整，或者指定固定的宽度和高度，例如：self.setFixedSize(400, 300)
        #-----------------------------------------------------------------------------------------------------初始化代码结束
    def initialize_table_view(self):
        # 查询数据库表rx_log的实际列名
        self.cursor.execute("PRAGMA table_info(rx_log)")
        self.columns = [row[1] for row in self.cursor.fetchall()]

        # 初始化数据模型(为了后面绑定表头)
        model = QStandardItemModel()
        # 定义期望的表头映射
        header_mapping = {
            'date': '日期',
            'time': '时间',
            'sn': '通联序号',
            'rx_callsign': '呼号',
            'rx_signal': '对方信号',
            'tx_signal': '我方信号',
            'qth': 'QTH',
            'rig': '使用设备',
            'power': '功率',
            'for_info': '通联方式(频率)',
            'op': '操作员',
        }

        # 根据实际列名和映射关系生成新的表头
        new_header_labels = [header_mapping.get(col, col) for col in self.columns]
        model.setHorizontalHeaderLabels(new_header_labels)
        # 将数据模型绑定到表格视图
        self.ui.suoyoulog_tableView.setModel(model)

        # 隐藏指定列
        hidden_columns = [self.columns.index('id'), self.columns.index('date_time')]  # 需要隐藏的列索引（对应id和date_time列）
        for column_index in hidden_columns:
            self.ui.suoyoulog_tableView.setColumnHidden(column_index, True)

        # 创建一个居中对齐的代理
        center_delegate = CenterAlignedItemDelegate()
        # 为表格视图中的所有列设置居中对齐的代理
        for column in range(model.columnCount()):
            self.ui.suoyoulog_tableView.setItemDelegateForColumn(column, center_delegate)


    def update_table_view(self, query=None):  # 修改：添加可选的查询参数query，默认为None
        # 如果query未提供，则使用默认查询语句（查询所有数据）
        if query is None:
            query = "SELECT * FROM rx_log ORDER BY date_time DESC"

        # 使用传入的查询语句执行查询
        self.cursor.execute(query)
        rows = self.cursor.fetchall()
        # 获取已绑定的数据模型
        model = self.ui.suoyoulog_tableView.model()

        # 清空模型现有数据
        model.removeRows(0, model.rowCount())
        #-----------------------下面是默认显示数据表功能-------------------------------------

        # 将查询结果转换为模型项并添加到模型中
        for row in rows:
            items = [QtGui.QStandardItem(str(v)) for v in row]
            model.appendRow(items)
        # 设置表格视图的模型 保留意见 看是否运行正常-------------------------------------------------------------------
        # self.ui.suoyoulog_tableView.setModel(model)
        # 隐藏指定列
        hidden_columns = [self.columns.index('id'), self.columns.index('date_time')]  # 需要隐藏的列索引（对应id和date_time列）
        for column_index in hidden_columns:
            self.ui.suoyoulog_tableView.setColumnHidden(column_index, True)
        # 设置表格视图的列宽自适应
        self.ui.suoyoulog_tableView.resizeColumnsToContents()
        # 调整列宽，使每列比自适应宽度大5像素
        for column in range(model.columnCount()):
            width = self.ui.suoyoulog_tableView.columnWidth(column) + 20
            self.ui.suoyoulog_tableView.setColumnWidth(column, width)

    def log_xuanze_Button(self):
        # 获取当前被选中的RadioButton
        selected_button = self.sender()
        self.ui.search_callsign_lineEdit.clear()  # 清空search_callsign_lineEdit
        # 设置zonggongtonglian_label为“0”
        self.ui.zonggongtonglian_label.setText("0")
        # 如果不是自定义日期范围按钮，禁用相关控件并设置为灰色
        if selected_button not in [self.ui.zidingyi_xuanze_Button, self.ui.shaixuan_pushButton]:
            self.ui.kaishi_dateTimeEdit.setReadOnly(True)
            self.ui.jiezhi_dateTimeEdit.setReadOnly(True)
            self.ui.shaixuan_pushButton.setEnabled(False)
            self.ui.kaishi_dateTimeEdit.setStyleSheet("color: gray;")  # 改为灰色
            self.ui.jiezhi_dateTimeEdit.setStyleSheet("color: gray;")   # 改为灰色
        else:  # 自定义日期范围按钮或筛选按钮被选中
            # 给query赋予一个默认值（选择所有数据的查询语句）
            query = "SELECT * FROM rx_log ORDER BY date_time DESC"
            self.ui.kaishi_dateTimeEdit.setReadOnly(False)
            self.ui.jiezhi_dateTimeEdit.setReadOnly(False)
            self.ui.shaixuan_pushButton.setEnabled(True)
            self.ui.kaishi_dateTimeEdit.setStyleSheet("")  # 清除样式，恢复默认颜色
            self.ui.jiezhi_dateTimeEdit.setStyleSheet("")  # 清除样式，恢复默认颜色


        # 处理不同按钮的选择
        if selected_button == self.ui.all_xuanze_Button:
            # 选择全部，恢复默认显示
            query = "SELECT * FROM rx_log ORDER BY date_time DESC"
            self.ui.shaixuan_label.setText("已累计通联：")
            hejitonglian_query = "SELECT COUNT(DISTINCT rx_callsign) FROM rx_log WHERE rx_callsign IS NOT NULL"
            hejitonglian_count = self.execute_query(hejitonglian_query)[0][0]
            self.ui.hejitonglian_label.setText(f"{hejitonglian_count}")
        elif selected_button == self.ui.today_xuanze_Button:
            # 选择今天
            today = datetime.now().strftime('%Y-%m-%d')
            query = f"SELECT * FROM rx_log WHERE date_time LIKE '{today}%' ORDER BY date_time DESC"
            self.ui.shaixuan_label.setText("今日已通联：")
            hejitonglian_query = f"SELECT COUNT(DISTINCT rx_callsign) FROM rx_log WHERE date_time LIKE '{today}%'"
            hejitonglian_count = self.execute_query(hejitonglian_query)[0][0]
            self.ui.hejitonglian_label.setText(f"{hejitonglian_count}")
        elif selected_button in [self.ui.day3_xuanze_Button, self.ui.day7_xuanze_Button, self.ui.day30_xuanze_Button, self.ui.day90_xuanze_Button]:
            # 选择近3天、近7天、近30天、近90天
            match = re.search(r'day(\d+)_xuanze_Button', selected_button.objectName())
            if match:
                period = match.group(1)
            else:
                raise ValueError("Invalid objectName format")

            end_date = datetime.now()  # 包含今天，将今天作为结束日期
            start_date = end_date - timedelta(days=int(period) + 1)  # 计算开始日期，不包含今天，加1天以包含今天

            # 将开始日期和结束日期转换为字符串，以匹配数据库中date_time字段的格式
            start_date_str = start_date.strftime('%Y-%m-%d %H:%M:%S')
            end_date_str = end_date.strftime('%Y-%m-%d %H:%M:%S')

            query = f"SELECT * FROM rx_log WHERE STRFTIME('%Y-%m-%d %H:%M:%S', date_time) BETWEEN '{start_date_str}' AND '{end_date_str}' ORDER BY date_time DESC"
            self.ui.shaixuan_label.setText(f"近{period}天通联：")
            hejitonglian_query = f"SELECT COUNT(DISTINCT rx_callsign) FROM rx_log WHERE STRFTIME('%Y-%m-%d %H:%M:%S', date_time) BETWEEN '{start_date_str}' AND '{end_date_str}'"
            hejitonglian_count = self.execute_query(hejitonglian_query)[0][0]
            self.ui.hejitonglian_label.setText(f"{hejitonglian_count}")

        elif selected_button == self.ui.shaixuan_pushButton:
            # 获取日期和时间部分
            start_date_str = self.ui.kaishi_dateTimeEdit.dateTime().date().toString("yyyy-MM-dd")
            start_time_str = self.ui.kaishi_dateTimeEdit.dateTime().time().toString("HH:mm:ss")

            end_date_str = self.ui.jiezhi_dateTimeEdit.dateTime().date().toString("yyyy-MM-dd")
            end_time_str = self.ui.jiezhi_dateTimeEdit.dateTime().time().toString("HH:mm:ss")
            # 拼接日期和时间部分
            start_datetime_str = f"{start_date_str} {start_time_str}"
            end_datetime_str = f"{end_date_str} {end_time_str}"

            # 打印出来一个判断 检查时间是否正确
            print(f"开始时间：{start_datetime_str}")
            print(f"结束时间：{end_datetime_str}")

            query = f"SELECT * FROM rx_log WHERE date_time BETWEEN '{start_datetime_str}' AND '{end_datetime_str}' ORDER BY date_time DESC"
            self.ui.shaixuan_label.setText("筛选出通联：")
            hejitonglian_query = f"SELECT COUNT(DISTINCT rx_callsign) FROM rx_log WHERE date_time BETWEEN '{start_datetime_str}' AND '{end_datetime_str}' AND rx_callsign IS NOT NULL"
            hejitonglian_count = self.execute_query(hejitonglian_query)[0][0]
            self.ui.hejitonglian_label.setText(f"{hejitonglian_count}")

            # 更新表格视图 放在这里会闪退
            # self.update_table_view(query)

        # 如果不是选择全部，暂停定时器5秒
        if selected_button != self.ui.all_xuanze_Button:
            self.timer.stop()

        # 更新表格视图
        self.update_table_view(query)
    # 统计总共通联数量 不重复
    def count_unique_callsigns(self):
        query = "SELECT COUNT(DISTINCT rx_callsign) FROM rx_log WHERE rx_callsign IS NOT NULL"
        self.cursor.execute(query)
        count = self.cursor.fetchone()[0]
        self.ui.hejitonglian_label.setText(f"{count}")
    # 定时器连接点，定时更新表格视图/计算唯一呼号数量
    def refresh_data(self):
        self.update_table_view()
        self.count_unique_callsigns()

    # 执行SQL查询并返回结果，在上方筛选近X日数据中调用
    def execute_query(self, query):
        self.cursor.execute(query)
        rows = self.cursor.fetchall()
        return rows

    #---------------------------------以下是呼号搜索框的功能实现-----------------开始----------------
    def on_search_callsign_changed(self, text):
        # 限制输入字符，只允许大小写字母、数字和一条斜杠
        allowed_chars = re.compile(r'^[A-Za-z0-9\/]*$')
        if not allowed_chars.match(text):
            self.ui.search_callsign_lineEdit.setText(text[:-1])  # 移除最后一个非法字符
            return
        # 当输入文本为空时，显示所有数据
        if not text:
            self.ui.zonggongtonglian_label.setText("0")
            query = "SELECT * FROM rx_log ORDER BY date_time DESC"
            self.update_table_view(query)
            return

        # 根据输入文本进行模糊匹配查询
        query = f"SELECT * FROM rx_log WHERE rx_callsign LIKE '%{text}%' ORDER BY date_time DESC"
        hejitonglian_query = f"SELECT COUNT(*) FROM rx_log WHERE rx_callsign LIKE '%{text}%'"
        hejitonglian_count = self.execute_query(hejitonglian_query)[0][0]

        # 更新匹配数量标签和表格视图数据
        self.ui.zonggongtonglian_label.setText(f"{hejitonglian_count}")
        self.update_table_view(query)


    def on_search_callsign_focus_in(self, event):
        self.timer.stop()  # 当光标进入search_callsign_lineEdit时，暂停定时器
        # 当光标进入search_callsign_lineEdit时，检查当前是否选择了今天、近3天、近7天、近30天或近90天
        if self.ui.today_xuanze_Button.isChecked() or self.ui.day3_xuanze_Button.isChecked() or \
           self.ui.day7_xuanze_Button.isChecked() or self.ui.day30_xuanze_Button.isChecked() or \
           self.ui.day90_xuanze_Button.isChecked() or self.ui.zidingyi_xuanze_Button.isChecked():
            # 如果已选择上述日期范围之一，取消选中并恢复为选择全部
            self.ui.all_xuanze_Button.setChecked(True)
            self.ui.today_xuanze_Button.setChecked(False)
            self.ui.day3_xuanze_Button.setChecked(False)
            self.ui.day7_xuanze_Button.setChecked(False)
            self.ui.day30_xuanze_Button.setChecked(False)
            self.ui.day90_xuanze_Button.setChecked(False)
            self.ui.zidingyi_xuanze_Button.setChecked(False)

            # 触发all_xuanze_Button的点击事件
            self.ui.all_xuanze_Button.click()


    def on_search_callsign_focus_out(self, event):
        self.timer.start()  # 当光标离开search_callsign_lineEdit时，恢复定时器
        # 恢复之前保存的输入法状态
        pass

    #---------------------------------以上是呼号搜索框的功能实现-----------------结束----------------
    #---------------------------------以上是清除日志的功能实现-----------------开始----------------
    def on_clearlog_button_clicked(self):
        # 弹出确认清空日志对话框
        reply = QMessageBox.question(
            self,
            "确认清空通联日志",
            "　　亲爱的友台，这些通联记录都是你的心血，\n是否确认清空所有通联日志？\n\n--- 清空后无法找回，请慎重考虑！---",
            QMessageBox.Yes | QMessageBox.No,
            QMessageBox.No
        )

        if reply == QMessageBox.Yes:
            # 弹出密码输入对话框
            password, ok = QInputDialog.getText(
                self,
                "请输入密码",
                "请输入日志删除密码："
            )

            if ok and password:
                # 查询日志删除密码
                self.cursor.execute("SELECT content FROM config WHERE name='日志删除密码'")
                #stored_password = self.cursor.fetchone()[0] if self.cursor.fetchone() else None
                row = self.cursor.fetchone()
                if row:
                    stored_password = row[0]
                else:
                    stored_password = None

                if stored_password and password == stored_password:
                    # 密码正确，清空rx_log表
                    self.cursor.execute("DELETE FROM rx_log")
                    self.conn.commit()

                    # 显示成功提示
                    QMessageBox.information(
                        self,
                        "通联日志已清除",
                        "你的通联日志已全部清除，再会！"
                    )
                else:
                    # 密码错误，显示提示
                    QMessageBox.warning(
                        self,
                        "密码错误",
                        "亲爱的友台，密码不正确，看来你还没考虑好！"
                    )

        # 关闭游标和连接（建议在程序退出时关闭，这里仅作演示）
        #self.cursor.close()
        #self.conn.close()
    #---------------------------------以上是清除日志的功能实现-----------------结束----------------
    #---------------------------------以下是导出日志的功能实现-----------------开始----------------
    def on_tolog_pushButton_clicked(self):
        #self.logger.debug("on_tolog_pushButton_clicked method entered")  # 添加日志输出
        # 暂停定时器
        self.timer.stop()
        # ---------------------------------------防止循环导出 方案一：临时断开按钮点击事件连接----------开始----------------------------
        self.ui.tolog_pushButton.clicked.disconnect()  # 断开点击事件连接- 避免循环导出三次日志 特别重要 init里面没有 只需要开这里 和后面恢复
        # ---------------------------------------防止循环导出 方案一：临时断开按钮点击事件连接----------结束----------------------------
        # ---------------------------------------防止循环导出 方案二：使用标志位防止重复导出----------开始----------------------------
        '''在init初始化中还有 self.is_exporting = False 进行配套'''
        #if self.is_exporting:
            #return  # 若正在导出，则直接返回，避免重复导出
        #self.is_exporting = True  # 设置标志位，表示导出正在进行
        # ---------------------------------------防止循环导出 方案二：使用标志位防止重复导出----------结束----------------------------
        current_time = datetime.now().strftime('%Y%m%d_%H%M%S')
        default_filename = f"{current_time} 导出的通联日志.xlsx"

        save_path, _ = QFileDialog.getSaveFileName(
            self,
            "导出通联日志",
            default_filename,
            "Microsoft Excel files (*.xlsx)",
            options=QFileDialog.DontConfirmOverwrite  # 可选：禁用覆盖确认对话框
        )
        #-----------------------------------------------------方案二：使用标志位防止重复导出 的恢复功能------开始---------
        # self.is_exporting = False  # 导出结束后重置标志位
        #-----------------------------------------------------方案二：使用标志位防止重复导出 的恢复功能------结束---------
        if save_path:
            # 检查文件扩展名并替换为.xlsx
            if save_path.endswith('.xlsx'):
                
                try:
                    # 获取QTableView的模型
                    table_model = self.ui.suoyoulog_tableView.model()

                    # 定义表头映射和需要排除的表头
                    header_mapping = {'date': '日期', 'time': '时间', 'sn': '通联序号', 'rx_callsign': '呼号', 'rx_signal': '对方信号', 'tx_signal': '我方信号', 'qth': 'QTH', 'rig': '使用设备', 'power': '功率', 'for_info': '通联方式(频率)', 'op': '操作员'}
                    exclude_headers = {'id', 'date_time'}

                    # 构建新的表头
                    header = []
                    for column in range(table_model.columnCount()):
                        header_text = table_model.headerData(column, Qt.Horizontal)
                        if header_text not in exclude_headers and header_text in header_mapping:
                            header.append(header_mapping[header_text])
                        elif header_text not in exclude_headers:
                            header.append(header_text)

                    # 构建数据行
                    data = []
                    for row in range(table_model.rowCount()):
                        row_data = []
                        for column in range(table_model.columnCount()):
                            if table_model.headerData(column, Qt.Horizontal) not in exclude_headers:
                                row_data.append(table_model.data(table_model.index(row, column)))
                        data.append(row_data)

                    # 将数据转换为DataFrame，方便后续处理
                    df = pd.DataFrame(data, columns=header)

                    # 创建工作簿和工作表
                    wb = openpyxl.Workbook()
                    ws = wb.active

                    # 合并第一行单元格并设置样式
                    merged_range = f'A1:{chr(ord("A") + len(header) - 1)}1'  # 自动计算合并范围
                    ws.merge_cells(merged_range)
                    ws['A1'].alignment = Alignment(horizontal='center', vertical='center')
                    ws['A1'].font = Font(size=22, name='黑体')  #如果加粗就加上, bold=True
                    ws['A1'] = '业余无线电通联日志（Contact Log）'

                    # 计算数据的实际列数有多少（方便加框线）
                    data_columns = len(df.columns)
                    print("一共有：",data_columns,"列")
                    # 添加导出时间（移动到倒数第四列，并合并倒数第1、2、3列）
                    ws.cell(row=2, column=data_columns - 3, value='导出时间：')
                    # ws.merge_cells(f'{chr(ord("A") + data_columns - 3)}2:{chr(ord("A") + data_columns - 1)}2')  # 合并倒数第1、2、3列
                    merge_range_B = f'{chr(ord("A") + data_columns - 3)}2:{chr(ord("A") + data_columns - 1)}2'  # ASCII值来计算出列字母 A通常是65 相当于65+11-3=73（对应的十进制ASCII就是I）
                    print("合并范围是：",merge_range_B)
                    ws.merge_cells(merge_range_B) #   执行合并获得的列字母
                    # 获取合并区域左上角单元格并设置值
                    merge_range_B_cell = ws.cell(row=2, column=data_columns - 2)  # 计算的是具体列索引，在Python中，列索引是从0开始计数的，所以第1列是0，第11列是10
                    merge_range_B_cell.value = datetime.now().strftime('%Y-%m-%d %H:%M:%S')
                    #ws.cell(row=2, column=data_columns - 1, value=datetime.now().strftime('%Y-%m-%d %H:%M:%S'))  # 放置导出时间在合并后的单元格内
                    # 写入数据
                    for r in dataframe_to_rows(df, index=False, header=True):
                        ws.append(r)

                    # 为从第三行数据到最后一行数据添加框线
                    for row in range(3, ws.max_row + 1):  # 从第三行开始
                        for col in range(1, data_columns + 1):  # 根据数据的实际列数限制框线范围
                            cell = ws.cell(row=row, column=col)
                            cell.border = Border(
                                left=Side(style='thin'),
                                right=Side(style='thin'),
                                top=Side(style='thin'),
                                bottom=Side(style='thin')
                            )
                    # 设置第三行（表头映射行）填充为#d9d9d9
                    for column in range(len(header)):
                        cell = ws.cell(row=3, column=column + 1)
                        cell.fill = PatternFill(start_color='d9d9d9', end_color='d9d9d9', fill_type='solid')
                        cell.font = Font(name='黑体', bold=False)  # 加粗文字
                        cell.alignment = Alignment(horizontal='center', vertical='center')  # 文字居中
                    # 设置第一行的表头样式
                    #for cell in ws['1:1']:
                    #    cell.font = Font(bold=True,size=22)
                    #    cell.fill = PatternFill(start_color='d9d9d9', end_color='d9d9d9', fill_type='solid')
                    # 遍历数据区域，为每个单元格设置居中对齐
                    # 遍历写入的数据区域，为每个单元格设置居中对齐
                    data_start_row = 4  # 数据区域从第四行开始
                    data_end_row = ws.max_row  # 数据区域最后一行为当前工作表的最大行数
                    for row in range(data_start_row, data_end_row + 1):
                        for column in range(1, len(header) + 1):
                            cell = ws.cell(row=row, column=column)
                            cell.alignment = Alignment(horizontal='center', vertical='center')
                    for column in range(1, len(header) + 1):
                        column_cells = ws.iter_rows(min_row=data_start_row, max_row=ws.max_row, min_col=column, max_col=column, values_only=True)
                        max_cell_length = max(len(str(cell)) for cell in column_cells if cell is not None)
                        ws.column_dimensions[get_column_letter(column)].width = max_cell_length * 1.2
                    # 保留一些额外宽度以避免单元格内容被截断
                    #for column_dimension in ws.column_dimensions.values():
                    #    column_dimension.width += 2    

                    wb.save(save_path)
                    
                    QMessageBox.information(self, "导出日志成功", "通联日志已成功导出至：\n" + save_path)
                    # 检查呼号查询输入框是否有内容
                    search_callsign_text = self.ui.search_callsign_lineEdit.text()
                    if search_callsign_text:
                        self.ui.search_callsign_lineEdit.clear()  # 清空输入框内容

                        # 将总共通联标签文本改为"0"
                        self.ui.zonggongtonglian_label.setText("0")

                        # 选中全部选项按钮
                        self.ui.all_xuanze_Button.setChecked(True)
                except Exception as e:
                    QMessageBox.critical(self, "导出日志失败", f"导出过程中发生错误：{str(e)}")
                self.ui.tolog_pushButton.clicked.connect(self.on_tolog_pushButton_clicked)  # 重新连接点击事件，导出失败也需要重新来！
            else:
                save_path += '.xlsx'
                QMessageBox.warning(self, "警告", "请选择.xlsx文件进行保存！")
        else:
            QMessageBox.information(self, "取消日志导出", "您已取消通联日志导出操作。")
        self.ui.tolog_pushButton.clicked.connect(self.on_tolog_pushButton_clicked)  # 用户取消操作，也重新连接点击事件，避免取消了就没法点导出了
    #---------------------------------以下是导出日志的功能实现-----------------结束----------------


# 确保这个类被正确导出
__all__ = ['LooklogWindow']